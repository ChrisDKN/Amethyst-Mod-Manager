#!/bin/bash
# AppRun - Mod Manager AppImage launcher

APPDIR="$(dirname "$(readlink -f "$0")")"
PYTHON_PREFIX="${APPDIR}/opt/python3.13"

# Library path for bundled shared libs
export LD_LIBRARY_PATH="${APPDIR}/usr/lib:${LD_LIBRARY_PATH}"

# Tcl/Tk paths (bundled with python-appimage)
export TCL_LIBRARY="${APPDIR}/usr/share/tcltk/tcl8.6"
export TK_LIBRARY="${APPDIR}/usr/share/tcltk/tk8.6"
export TKPATH="${TK_LIBRARY}"

# SSL certificate
export SSL_CERT_FILE="${APPDIR}/opt/_internal/certs.pem"

# Profiles directory â€” writable location outside the read-only AppImage mount
export MOD_MANAGER_PROFILES_DIR="${XDG_CONFIG_HOME:-$HOME/.config}/AmethystModManager/Profiles"
mkdir -p "$MOD_MANAGER_PROFILES_DIR"

# Launch
cd "${APPDIR}/usr/app"
exec "${PYTHON_PREFIX}/bin/python3.13" gui.py "$@"
